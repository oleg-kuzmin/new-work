# `fetch()`

С помощью функции `fetch()` можно отправлять сетевые запросы на сервер — как получать, так и отправлять данные. Метод возвращает промис с объектом ответа, где находится дополнительная информация (статус ответа, заголовки) и ответ на запрос.

Браузер предоставляет глобальный API для работы с запросами и ответами HTTP. Раньше для подобной работы использовался `XMLHttpRequest`, однако `fetch()` более гибкая и мощная альтернатива, он понятнее и проще в использовании из-за того, что использует `Promise`.

Метод `fetch` асинхронный. Когда вы его вызываете, он создаёт промис, а когда получает ответ — переводит промис в нужный статус. Ответ от сервера при этом записывается в промис, так что его можно использовать через `.then` и `.catch`.

## Синтаксис

```js
fetch('url', options);
```

### `url (Строка)`

Адрес, по которому нужно сделать запрос. По умолчанию вызов `fetch()` делает `GET-запрос` по указанному адресу.

### `options (Объект)` / опционально

Лбъект конфигурации, в котором можно настроить метод запроса, тело запроса, заголовки и многое другое.

```js
const options = {
  // Метод запроса
  method: 'POST', // GET, PUT, DELETE

  // Тело запроса в JSON-формате
  body: JSON.stringify(newPost),

  // Заголовки
  headers: {
    'Content-type': 'application/json; charset=UTF-8',
  },

  // для включения cookies в запрос
  credentials: 'include',

  // для включения cookies в запрос (в пределах домена)
  credentials: 'same-origin',
};
```

## Возвращает

### `object promise`

`.state` - `fulfilled` || `rejected`

`.result` - `объект responce с собственными методами`

#### Объект responce

```js
{
  // Код статуса ответа от сервера.
  status: "200",

  // Сообщение статуса ответа от сервера - оно объясняет, что произошло.
  statusText: "OK",

  // Свойство принимает состояние и сообщает об успешности запроса:
  // - true (если ответ успешный: начинается с 200)
  // - false (в любом другом случае)
  ok: true;
}
```

#### Методы объекта responce

##### `.json()`

Асинхронный метод, вызов которого возвращает `Promise` c объектом ответа от сервера, преобразованного из json-формата в привычный объект JavaScript.

```js
fetch('http://jsonplaceholder.typicode.com/posts')
  .then(response => response.json())
  .then(data => data);
```

##### `.text()`

Асинхронный метод, вызов которого возвращает `Promise` c объектом ответа от сервера, преобразованного в текст.

##### `.blob()`

Асинхронный метод, вызов которого возвращает `Promise` c объектом ответа от сервера, преобразованного как бинарные данные (это нужно при получении файлов: изображений, видео, pdf-документов).

##### `.headers.get()`

Для работы с заголовками есть специальные методы. Чтобы получить значение заголовка, есть метод `get()`. Заголовки ответа можно только читать, но нельзя редактировать.

```js
fetch('http://jsonplaceholder.typicode.com/posts')
  .then(response => {
    if (res.headers.get('Content-Type').contains('application/json')) {
      return res.json();
    }
  })
  .then(data => data);
```

## Функция для проверки ответа

```js
function checkResponse(response) {
  return response.ok ? response.json() : Promise.reject(`Ошибка: ${response.status}`);
}
```
