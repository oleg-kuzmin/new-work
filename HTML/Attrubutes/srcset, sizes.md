# `srcset`, `sizes`

HTML даёт возможность загружать разные изображения в зависимости от разных условий. Частая ситуация: разные картинки под разные ширины экранов.

Можно делать это при помощи тега `<picture>`, а можно задать атрибуты srcset и sizes прямо в теге `<img>`.

`srcset` — В атрибуте `srcset` через запятую перечисляются строки, которые дают браузеру информацию об изображениях. Каждая строка состоит из следующих частей:

- URL изображения (например, `1024x768.png`);
- целое число, за которым идёт буква w (например, `1024w`). Число указывает на ширину изображения в пикселях;
- число, за которым идёт буква x (например, `1.5x`). Число указывает на плотность пикселей, для которой будет использоваться изображение.

`sizes` — Атрибут sizes говорит браузеру, какой ширины нам понадобится изображение из текущего элемента `<source>` при отрисовке страницы. Можно сказать, что браузер определяет ширину слота для изображения. Так мы заранее сообщаем браузеру, сколько места на странице «забронировать» под изображение. Значением атрибута может быть либо абсолютное значение (например, `150px` или `30em`), либо относительное (например, `20vw`). Значения в процентах не разрешены.

- Использование атрибутов srcset и sizes отлично работает и просто в теге `<img>`, а теги `<source>` чаще всего используются совместно с атрибутом type. Подготовка и указание изображений, видео или аудио различных типов помогает браузеру выбрать наиболее эффективный поддерживаемый формат.

### Как браузер читает эти атрибуты:

1. Смотрит на ширину экрана устройства.
2. Пытается определить подходящее условие из списка в атрибуте sizes.
3. Смотрит на размер блока для изображения к этому медиавыражению.
4. Загружает то изображение из списка в srcset, которое имеет тот же размер, что и выбранный слот. Если такого нет, то загрузится первое изображение, которое больше размера выбранного слота.

Браузер остановит проверку и чтение атрибутов, как только найдёт совпадение с условием. Поэтому располагайте условия от меньших к большим.

## Применяется к тегам

- [`<img>`](../../TAGS/MEDIA/img.md) изображение
- [`<source>`](../../TAGS/MEDIA/source.md) источник медиа

## Пример

### `<img>`

```html
<img src="logo.png" srcset="logo@2x.png 2x" alt="Логотип: собака, бегущая за мячом, изображено схематично" />

<!-- На экранах от 0 до 320 пикселей загрузится logo-small.png. -->
<!-- На экранах от 321 до 480 пикселей загрузится logo-medium.png. -->
<!-- На всех прочих ширинах (или если браузер не поддерживает эти атрибуты) загрузится logo-large.png. -->
<img
  src="logo-large.png"
  srcset="logo-small.png 320w, logo-medium.png 480w, logo-large.png 800w"
  sizes="
    (max-width: 320px) 280px,
    (max-width: 480px) 440px,
    800px"
  alt="Логотип: собака, бегущая за мячом, изображено схематично"
/>
```

### `<source>`

Эта запись означает, что для экранов с обычной плотностью пикселей будет использовано изображение `640x480.png`, а для экранов с удвоенной плотностью пикселей (например, для retina-экранов) — `1280x960.png`.

```html
<source srcset="640x480.png 1x, 1280x960.png 2x" />
```

Здесь мы говорим браузеру, что изображение `1024x768.png` имеет ширину `1024px`, а изображение `640x480.png` — `640px`. Эта информация помогает браузеру определить, какое изображение выбрать при разборе соседнего атрибута sizes.

```html
<source srcset="1024x768.png 1024w, 640x480.png 640w" />
```

Когда браузер разбирает тег `<source>`, он выполняет следующие действия:

- смотрит на текущую ширину окна браузера;
- ищет подходящий вариант из атрибута `sizes`, с учётом плотности пикселей;
- выбирает из атрибута `srcset` подходящую картинку для слота: больше или равную ему.

Как сработает наш пример при разных ширинах:

- 1000 пикселей: срабатывает условие (`max-width: 1200px`) (1200 пикселей или меньше), и браузер устанавливает ширину слота `50vw` (500 пикселей в нашем случае). Из списка `srcset` браузер выбирает подходящую картинку: на 1x-экране покажется `600x100.png`, на 2x-экране покажется `1000x200.png` — ближайшие к ширине слота 500 пикселей.
- 1201 пиксель: не срабатывает условие (`max-width: 1200px`), и ширина слота выбирается из списка `sizes` — это `1000px`. У браузера в `srcset` самая большая картинка `1000x200.png 1000w` равна ширине слота, а значит и на 1x-, и на 2x-экране будет картинка `1000x200.png`.

```html
<source srcset="images/600x100.png 600w, images/1000x200.png 1000w" sizes="(max-width: 1200px) 50vw, 1000px" />
```
